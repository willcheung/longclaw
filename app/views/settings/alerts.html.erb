<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <h2>Alerts Settings</h2>
        <ol class="breadcrumb">
            <li>
                <a href="<%= root_path %>">Home</a>
            </li>
            <li>
                <a href="<%= settings_path%>">Settings</a>
            </li>
            <li class="active">
                <strong>Alerts</strong>
            </li>
        </ol>
    </div>
</div>

<div class="wrapper wrapper-content animated fadeInRight">
    <div class="ibox">
        <div class="ibox-content">
            <h1>Risk Metrics</h1>
            <div class="form-inline">
                <label>Level:</label>
                <select id="select-metric-level" class="form-control">
                    <option>Organization</option>
                    <option>Account (Coming Soon)</option>
                    <option>Stream (Coming Soon)</option>
                </select>
                <div class="form-group" style="display: none;">
                  <select class="form-control">
                      <option>Stark Industries</option>
                      <option>Hooli</option>
                      <option>Pied Piper</option>
                  </select>
                  <span>Settings currently inherited from Organization level</span>
                </div>
                <button id="edit-btn" class="btn btn-info" style="display: none;">Edit</button>
                <button id="save-btn" class="btn btn-primary">Save</button>
            </div>
            <table class="table table-condensed responsive no-wrap m-t-sm">
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Average</th>
                        <th>Medium Threshold</th>
                        <th>High Threshold</th>
                        <th>Risk Score Weight</th>
                        <th>Add to Smart Tasks</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Negative Sentiment Score</td>
                        <td>45</td>
                        <td>-</td>
                        <td><input type="text" class="form-control" value="80"></td>
                        <td>-</td>
                        <td><input type="checkbox" name="" checked></td>
                    </tr>
                    <tr>
                        <td>% Negative Sentiment</td>
                        <td>7% (Last 30d)</td>
                        <td><input type="text" class="form-control" value="<%= @risk_settings.pns_med_thresh %>%"></td>
                        <td><input type="text" class="form-control" value="<%= @risk_settings.pns_high_thresh %>%"></td>
                        <td><input type="text" class="form-control" value="<%= @risk_settings.pns_weight %>%"></td>
                        <td><input type="checkbox" name=""></td>
                    </tr>
                    <tr>
                        <td>Days Inactive</td>
                        <td>9</td>
                        <td><input type="text" class="form-control" value="<%= @risk_settings.inactive_med_thresh %>"></td>
                        <td><input type="text" class="form-control" value="<%= @risk_settings.inactive_high_thresh %>"></td>
                        <td><input type="text" class="form-control" value="<%= @risk_settings.inactive_weight %>%"></td>
                        <td><input type="checkbox" name=""></td>
                    </tr>
                    <tr>
                        <td>Days Until Renewal</td>
                        <td>80</td>
                        <td><input type="text" class="form-control" value="<%= @risk_settings.renewal_med_thresh %>"></td>
                        <td><input type="text" class="form-control" value="<%= @risk_settings.renewal_high_thresh %>"></td>
                        <td><input type="text" class="form-control" value="<%= @risk_settings.renewal_weight %>%"></td>
                        <td><input type="checkbox" name=""></td>
                    </tr>
                    <tr>
                        <td>RAG Status</td>
                        <td>Green</td>
                        <td>Amber</td>
                        <td>Red</td>
                        <td><input type="text" class="form-control" value="<%= @risk_settings.rag_weight %>%"></td>
                        <td><input type="checkbox" name=""></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td><button id="add-btn" class="btn btn-success"><i class="fa fa-plus"></i></button></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<script type="text/javascript">
  $('#select-metric-level').change(function () {
    if ($(this).val() != 'Organization') {
      $(this).next().show();
      $('tbody tr').addClass('active');
      $('tbody input, tbody button').prop('disabled', true);
      $('#save-btn').hide();
      $('#edit-btn').show();
    }
    else {
      $(this).next().hide();
      $('tbody tr').removeClass('active');
      $('tbody input, tbody button').prop('disabled', false);
      $('#save-btn').show();
      $('#edit-btn').hide();
    }
  });

  $('#edit-btn').click(function () {
    $('#save-btn').show();
    $(this).hide();
    $('tbody tr').removeClass('active');
    $('tbody input, tbody button').prop('disabled', false);
  });

  $('#add-btn').click( function () {
    $(this).parent().parent().before(`
      <tr>
          <td>
              <select class="form-control">
                  <option>Risk Metric A</option>
                  <option>Risk Metric B</option>
                  <option>Risk Metric C</option>
              </select>
          </td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>)`);
  })
</script>