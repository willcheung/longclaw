var barColors = { 
  blue: '#7cb5ec', 
  highRisk: '#ed5565',
  mediumRisk: '#FFA500',
  lowRisk: '#A1C436'
};
var chart = $('#left-chart').highcharts()
chart.xAxis[0].setCategories(<%= @data.map(&:name).to_json.html_safe %>, false);
chart.series[0].update({ 
  name: "<%= @sort %>",
  data: [ <% @data.each do |d| %>
  {
    y: <%= d.y %>,
    color: barColors["<%= d.color %>"],
    id: "<%= d.id %>"
  },
  <% end %> ]
}, false);

<% if @sort == "Negative Sentiment Score" || @sort == "Risk Score" %>
chart.yAxis[0].update({min: 0, max: 100}, false);
chart.series[1].setData(<%= Array.new(@data.length, @average).to_json.html_safe %>)
chart.series[1].show();
<% else %>
chart.yAxis[0].update({min: undefined, max: undefined}, false);
chart.series[1].hide();
<% end %>

chart.redraw();
