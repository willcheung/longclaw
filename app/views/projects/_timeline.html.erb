<!-- Form -->
<div class="row header-box projects-box white-bg">
    <div class="col-lg-12">
        <div id="add-note-form" class="m-t">
            
            <%= render 'activities/form', :project_id => @project.id %>  
            
        </div>
    </div>
</div>

<!-- Filter Section -->
<div class="filter_section col-lg-12" style="padding-top: 10px; margin-right:0; padding-right:0;">
  <h4 id="filter-timeline-expand" style="margin-left:-15px" class="text-primary">
    <span><i class="fa fa-filter" style="font-size:16px; text-align: right; padding-top:4px" aria-hidden="true"></i> FILTER TIMELINE <i class="fa fa-caret-down" style="font-size:16px;" aria-hidden="true"></i></span>
  </h3>
  
  <div id="timeline-filters">
    <div class="row">
      <div class="col-lg-5">
        <i class="fa fa-tasks" aria-hidden="true"></i>
        <select class="comment_category col-lg-11" data-placeholder="  Filter by activity type" multiple="true">
          <option value="0"></option>
          <% Activity::CATEGORY.each{|k,v|    %>
            <option value="<%=v %>"  <% if @category_param.include?(v)  %> selected   <% end %> ><%=v %></option>
             <% } %> 
        </select>
      </div>

      <div class="col-lg-6">
        <i class="fa fa-users" aria-hidden="true"></i>
        <select class="user_filter col-lg-11" data-placeholder="  Filter by people" multiple="true">
          <option value="0"></option>
          <% @final_filter_user.each do |u| %>
            <option value="<%=u.email %>"  <% if @filter_email.include?(u.email)  %> selected   <% end %> >
              <% if u.first_name.include?('@')%>
                  <%=u.first_name%>
              <% else %>
                  <%=u.first_name+' '+u.last_name+'(@'+  get_short_name(get_domain(u.email))+')' %>
              <% end %>         
            </option>
          <% end %>
        </select>
      </div>
      <div class="col-lg-2"></div>
    </div>

    <div class="row" style="margin-left:0">
      <h4 class="m-t-sm"><i class="fa fa-clock-o m-r-xs" aria-hidden="true"></i> Filter by date <small>(Click and drag in graph to filter)</small></h4>
      <div class="col-lg-12" id="time-filter-highcharts" style="height: 100px; margin-bottom:10px; margin-right:0; padding-right:0;"></div>
    </div>
  </div>
</div>

<!-- Activities -->
<div id="newsfeed">
    <div class="row">
        <div class="col-lg-12">
            <div id="vertical-timeline" class="vertical-container light-timeline m-t">
                <% @activities_by_month.each do |month, activities| %>
                    <div class="vertical-timeline-month" data-myvalue='month'>
                        <h3 class="p-xs m-l-n-sm gray-bg"><%= month %></h3>
                    </div>
                    
                    <% activities.each do |a| %>
                        <%= render 'activities/timeline_block', a: a %>
                    <% end %>
                <% end %>

            </div>
        </div>
    </div>
</div>

<% if @activities_by_month.empty? %>
  <div class="p-m m-l m-t white-bg" style="width:100%;">
    <h4 class="text-center">You don't have any emails or notes for this project!</h4>
    <h4 class="text-center">To add a note for this project, type something into the area above and click on the <a class="btn btn-sm sticky-bg" style="display:inline;">Post</a> button.</h4>
  </div>
<% end %>

<%= javascript_include_tag 'activity_filter' %>

<script type="text/javascript">
  $("#newsfeed-link").parent().addClass("active");

  $("#filter-timeline-expand").click(function() {
    $("#timeline-filters").toggle();
  });
  $('#filter-timeline-expand').css( 'cursor', 'pointer' );
  
</script>